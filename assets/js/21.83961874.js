(window.webpackJsonp=window.webpackJsonp||[]).push([[21],{204:function(t,e,a){"use strict";a.r(e);var r=a(0),o=Object(r.a)({},function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"state-storage-and-locking"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#state-storage-and-locking","aria-hidden":"true"}},[t._v("#")]),t._v(" State Storage and Locking")]),t._v(" "),a("p",[a("a",{attrs:{href:"https://www.terraform.io/docs/state/",target:"_blank",rel:"noopener noreferrer"}},[t._v("State"),a("OutboundLink")],1),t._v(" 是 Terraform 最重要的資訊，如果沒有保存好，那麼 IaC 就有可能大亂。")]),t._v(" "),a("p",[t._v("Terraform 本身需要 "),a("code",[t._v("state")]),t._v(" 來判斷 Resource 的現況，若是 "),a("code",[t._v("state")]),t._v(" 不存在，Terraform 將不認得既有存在的服務，如果在沒有 "),a("code",[t._v("state")]),t._v(" 的情況下，Terraform 會以 New Resource 的方式新建資源。")]),t._v(" "),a("h2",{attrs:{id:"state-storage"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#state-storage","aria-hidden":"true"}},[t._v("#")]),t._v(" State Storage")]),t._v(" "),a("p",[t._v("當執行 "),a("code",[t._v("plan")]),t._v("、"),a("code",[t._v("apply")]),t._v(" 時 Terraform 會去參考 state 的資訊，以 "),a("code",[t._v("terraform.tfstate")]),t._v(" 命名檔案。")]),t._v(" "),a("p",[t._v("預設 "),a("code",[t._v("state")]),t._v(" 儲存在 "),a("code",[t._v("local")]),t._v("，為了避免遺失或多人開發，一般會透過 "),a("router-link",{attrs:{to:"/component/backends.html"}},[t._v("backends")]),t._v(" 儲存。")],1),t._v(" "),a("h2",{attrs:{id:"state-locking"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#state-locking","aria-hidden":"true"}},[t._v("#")]),t._v(" State Locking")]),t._v(" "),a("p",[t._v("當多人開發時，為了避免在同一時間重複執行 "),a("code",[t._v("apply")]),t._v(" 的 lock 機制，lock 的方法與使用的 "),a("router-link",{attrs:{to:"/component/backends.html"}},[t._v("backends")]),t._v(" 有關係，以 "),a("a",{attrs:{href:"https://www.terraform.io/docs/backends/types/s3.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Backend S3"),a("OutboundLink")],1),t._v(" 為例，Lock 則採用 "),a("a",{attrs:{href:"https://aws.amazon.com/tw/dynamodb/",target:"_blank",rel:"noopener noreferrer"}},[t._v("DynamoDB"),a("OutboundLink")],1),t._v("。")],1)])},[],!1,null,null,null);e.default=o.exports}}]);